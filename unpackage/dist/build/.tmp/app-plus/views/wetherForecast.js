(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["views/wetherForecast"],{"664e":function(t,e,n){"use strict";n.r(e);var a=n("f948"),i=n("9692");for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);var o=n("2877"),c=Object(o["a"])(i["default"],a["a"],a["b"],!1,null,null,null);e["default"]=c.exports},9692:function(t,e,n){"use strict";n.r(e);var a=n("cffc"),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);e["default"]=i.a},cffc:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n("a34a"));function i(t){return t&&t.__esModule?t:{default:t}}function r(t,e,n,a,i,r,o){try{var c=t[r](o),u=c.value}catch(s){return void n(s)}c.done?e(u):Promise.resolve(u).then(a,i)}function o(t){return function(){var e=this,n=arguments;return new Promise(function(a,i){var o=t.apply(e,n);function c(t){r(o,a,i,c,u,"next",t)}function u(t){r(o,a,i,c,u,"throw",t)}c(void 0)})}}n("faca");var c=function(){return n.e("components/common/uni-drawer").then(n.bind(null,"db11"))},u=function(){return n.e("components/general/chart_WeatherLine").then(n.bind(null,"0fb7"))},s=function(){return n.e("components/common/uni-swipe-action").then(n.bind(null,"8310"))},l={data:function(){return{wd:0,fl:0,sd:0,programGengduoBtn:!0,currentCity:"",currentType:"",currentIcon:"",wetherList:[],cityList:[],showRigth:!1,canvasHightData:[],canvasLowData:[],canvasNumData:0,canvasMaximum:0,canvasMinimum:0,opt:[{text:"删除",style:{backgroundColor:"rgb(255,58,49)"}}],slipRightLoad:!1}},onNavigationBarButtonTap:function(t){this.gengduoFun()},onLoad:function(e){e.label&&t.setNavigationBarTitle({title:e.label}),t.setNavigationBarColor({frontColor:"#ffffff",backgroundColor:"#48c6ef",animation:{duration:400,timingFunc:"easeIn"}}),e.cityName?this.currentCity=e.cityName:this.loadInfo(),this.programGengduoBtn=!1},watch:{currentCity:function(t,e){this.getWether(t)}},methods:{gengduoFun:function(){this.showRigth=!0},closeDrawer:function(){this.showRigth=!1},hide:function(){this.showRigth=!1},citySelector:function(){t.navigateTo({url:"/views/pages/citySelector"})},loadInfo:function(){var e=this;t.getLocation({type:"wgs84",success:function(t){var n=t.longitude,a=t.latitude;e.loadCity(a,n)},fail:function(n){t.showToast({title:"定位失败，默认查询成都"}),e.currentCity="成都",e.loadCity(30.64242,104.04311)}})},loadCity:function(t,e){var a=this,i=n("0547"),r={latitude:"",longitude:"",key:"c0e9d71cc639c613da5e2c5804b99a9d"},o=new i.AMapWX({key:r.key});o.getRegeo({success:function(t){a.currentCity=t[0].regeocodeData.addressComponent.city},fail:function(t){console.log(t," at views\\wetherForecast.vue:249")}})},getWether:function(e){var n=this;e.indexOf("市")>0&&(e=e.split("市")[0]),t.showLoading({title:"加载中"}),t.request({url:"http://apis.juhe.cn/simpleWeather/query",method:"GET",dataType:"json",header:{"Content-type":"application/json"},data:{city:e,key:"c9635a6433c99e58484af6aaffbbbd59"},success:function(){var e=o(a.default.mark(function e(i){var r,o,c,u,s,l,f,d,h,p,g,y,m,v,w,b,L,C,k,x;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=i.data.error_code,112!==r&&207301!==r){e.next=6;break}t.hideLoading(),t.showToast({title:i.data.reason,duration:2e3}),e.next=47;break;case 6:return o=i.data.result,n.wd=o.realtime.temperature,n.fl=o.realtime.power,n.sd=o.realtime.humidity,c=o.realtime.info.split("转")[1]?o.realtime.info.split("转")[1]:o.realtime.info.split("转")[0],n.currentType=c,e.next=14,n.getWZ(c);case 14:u=e.sent,n.currentIcon="icon-"+u,s=[],l="",f=[],d=[],n.canvasNumData=o.future.length,h=0;case 22:if(!(h<o.future.length)){e.next=37;break}return p=o.future[h].date.split("-"),g="",new Date(o.future[h].date).toDateString()===(new Date).toDateString()?(g="今天",l=o.future[h].temperature.replace("/","~")):g=p[1]+"-"+p[2],y=o.future[h].weather.split("转")[1]?o.future[h].weather.split("转")[1]:o.future[h].weather.split("转")[0],e.next=29,n.getWZ(y);case 29:m=e.sent,v={date:g,xq:n.getWeek(o.future[h].date),icon:"icon-"+m,type:y,wd:o.future[h].temperature.replace("/","~")},w=o.future[h].temperature.split("/"),parseInt(w[0])>parseInt(w[1])?(f.push(parseInt(w[0])),d.push(parseInt(w[1]))):(f.push(parseInt(w[1])),d.push(parseInt(w[0]))),s.push(v);case 34:h++,e.next=22;break;case 37:n.wetherList=[],n.wetherList=n.wetherList.concat(s),n.canvasHightData=n.canvasHightData.concat(f),n.canvasLowData=n.canvasLowData.concat(d),n.canvasMaximum=Math.max.apply(null,f),n.canvasMinimum=Math.min.apply(null,d),b={cityName:n.currentCity,wd:l},L=t.getStorageSync("chooseCitySelector"),L?(C=L,k=n.currentCity,k=-1===k.indexOf("市")?k.split("市")[0]:k,x=JSON.parse(C),C&&-1===C.indexOf(k)?(x.push(b),n.cityList=n.cityList.concat(x),t.setStorage({key:"chooseCitySelector",data:JSON.stringify(x)})):(n.cityList=n.cityList.concat(x),t.setStorage({key:"chooseCitySelector",data:JSON.stringify(x)}))):(n.cityList.push(b),t.setStorage({key:"chooseCitySelector",data:JSON.stringify(n.cityList)}),n.cityList=n.cityList.concat(b)),t.hideLoading();case 47:case"end":return e.stop()}},e,this)}));function i(t){return e.apply(this,arguments)}return i}(),fail:function(e){t.hideLoading(),console.log(e," at views\\wetherForecast.vue:376")}})},getWeek:function(t){var e;if(""===t)e=new Date;else{var n=t.split("-");e=new Date(n[0],parseInt(n[1]-1),n[2])}return"周"+"日一二三四五六".charAt(e.getDay())},getWZ:function(e){return new Promise(function(n,a){t.request({url:"https://helloacm.com/api/pinyin",method:"GET",dataType:"json",header:{"Content-type":"application/json"},data:{s:e},success:function(t){var e=t.data.result.join("");n(e)},fail:function(t){console.log(t," at views\\wetherForecast.vue:409"),a(t)}})})},itemFun:function(t){this.currentCity=t.cityName,this.showRigth=!1},bindClick:function(e){t.showToast({title:"点击了".concat(e.text,"按钮"),icon:"none"})}},components:{uniDrawer:c,chart_WeatherLine:u,uniSwipeAction:s}};e.default=l}).call(this,n("6e42")["default"])},f948:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c},i=[];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return i})}},[["c78a","common/runtime","common/vendor"]]]);